<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RAC Weekend Flash | 周末闪讯</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- html2canvas for Screenshot -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'neo-bg': '#e0e0e0',
                        'neo-main': '#FF4D4D', /* Hot Red */
                        'neo-accent': '#4D79FF', /* Electric Blue */
                        'neo-yellow': '#FFDE59', /* Warning Yellow */
                        'neo-green': '#7DFF86', /* Neon Green */
                        'neo-black': '#1a1a1a',
                        'neo-white': '#ffffff',
                    },
                    fontFamily: {
                        'mono': ['"Courier New"', 'Courier', 'monospace'],
                        'sans': ['"Helvetica Neue"', 'Arial', 'sans-serif'],
                        'display': ['Impact', 'Arial Black', 'sans-serif'],
                    },
                    boxShadow: {
                        'neo': '5px 5px 0px 0px rgba(0,0,0,1)',
                        'neo-sm': '3px 3px 0px 0px rgba(0,0,0,1)',
                        'neo-hover': '2px 2px 0px 0px rgba(0,0,0,1)',
                        'neo-lg': '8px 8px 0px 0px rgba(0,0,0,1)',
                    },
                    backgroundImage: {
                        'stripes': 'repeating-linear-gradient(45deg, #000 0, #000 1px, transparent 0, transparent 50%)',
                        'dots': 'radial-gradient(#000 1px, transparent 1px)',
                    },
                    animation: {
                        'breathe-glow': 'breathe-glow 2s infinite',
                        'slide-in': 'slide-in 0.3s cubic-bezier(0.16, 1, 0.3, 1)',
                        'fade-in': 'fadeIn 0.5s ease-out',
                    },
                    keyframes: {
                        'breathe-glow': {
                            '0%, 100%': { boxShadow: '0 0 0 0px rgba(255, 77, 77, 0.7)' },
                            '50%': { boxShadow: '0 0 0 10px rgba(255, 77, 77, 0)' },
                        },
                        'slide-in': {
                            'from': { transform: 'translateX(-100%)' },
                            'to': { transform: 'translateX(0)' },
                        },
                        'fadeIn': {
                            'from': { opacity: '0' },
                            'to': { opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom Neo-Brutalism Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f0f0f0;
            border-left: 2px solid black;
        }
        ::-webkit-scrollbar-thumb {
            background: #000;
        }
        
        .marquee-container {
            overflow: hidden;
            white-space: nowrap;
        }
        .marquee-content {
            display: inline-block;
            animation: marquee 20s linear infinite;
        }
        @keyframes marquee {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #000;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Safe area for iPhone */
        .safe-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }

        /* Detail Modal Typography */
        .prose-neo h3 {
            font-weight: 900;
            text-transform: uppercase;
            border-bottom: 3px solid black;
            padding-bottom: 4px;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            font-size: 1.25rem;
        }
        .prose-neo p {
            margin-bottom: 1rem;
            line-height: 1.6;
            font-size: 1rem;
        }
        .prose-neo strong {
            background-color: #FFDE59;
            padding: 0 4px;
        }
        .bg-dots-pattern {
            background-size: 10px 10px;
            background-image: radial-gradient(#000 1px, transparent 1px);
        }

        /* Custom animation for detail modal */
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }
        
        /* 新增：导出图片优化样式 */
        .export-optimized {
            font-size: 16px !important;
            line-height: 1.6 !important;
        }
        
        .export-optimized h1, 
        .export-optimized h2, 
        .export-optimized h3 {
            font-size: 24px !important;
            line-height: 1.4 !important;
            margin-bottom: 12px !important;
        }
        
        .export-optimized p {
            font-size: 16px !important;
            line-height: 1.6 !important;
            margin-bottom: 10px !important;
        }
        
        .export-optimized .analysis-content {
            font-size: 14px !important;
            line-height: 1.5 !important;
            padding: 12px !important;
            background-color: #f8f9fa !important;
            border-left: 4px solid #4D79FF !important;
        }
        
        /* 确保所有文字在导出时可见 */
        .text-export-safe {
            max-width: 100% !important;
            overflow-wrap: break-word !important;
            white-space: normal !important;
        }
        
        /* 响应式调整 */
        @media (max-width: 768px) {
            .export-optimized {
                font-size: 14px !important;
            }
            
            .export-optimized h1, 
            .export-optimized h2, 
            .export-optimized h3 {
                font-size: 20px !important;
            }
        }
    </style>
</head>
<body class="bg-neo-bg text-neo-black font-sans antialiased overflow-x-hidden">
    <div id="root"></div>

    <script type="text/babel">
        // --- 警告：在实际部署中，API密钥应该存储在服务器端，而不是客户端 ---
        const DEEPSEEK_API_KEY = "sk-b22bf27433b54cc5ab320a7c91d0cf36";
        const WECHAT_WORK_URL = "https://work.weixin.qq.com/kfid/kfc3dbd2c4dc22c9e4f";
        
        // UPDATED: Added Chinese names for categories
        const CATEGORIES = [
            { id: 'global', name: 'GLOBAL', nameCN: '国际资讯', icon: 'globe', color: 'bg-neo-yellow', imagePrompt: 'abstract flat vector illustration of global news, world map, people interacting with technology, bold colors, editorial style, no text' },
            { id: 'education', name: 'EDU', nameCN: '教育动态', icon: 'book', color: 'bg-neo-green', imagePrompt: 'bauhaus geometric shapes abstract education concept, students learning, books, graduation cap, no text' },
            { id: 'university', name: 'UNI', nameCN: '院校官网', icon: 'building', color: 'bg-neo-accent text-white', imagePrompt: 'architectural sketch of university campus, blueprint style, minimal, academic building, no text' },
            { id: 'design', name: 'DESIGN', nameCN: '设计趋势', icon: 'pen-tool', color: 'bg-neo-main text-white', imagePrompt: '3d render abstract art of design tools, creative process, digital art, claymorphism, vibrant colors, clean lines, no text' },
            { id: 'summer', name: 'SUMMER', nameCN: '暑期科研', icon: 'sun', color: 'bg-orange-400 text-white', imagePrompt: 'summer vibes collage art, paper cutout texture, students on vacation, research equipment, sunny day, no text' },
            { id: 'competitions', name: 'COMP', nameCN: '竞赛资讯', icon: 'trophy', color: 'bg-purple-400 text-white', imagePrompt: 'pixel art retro gaming aesthetic of a trophy, medals, competition winners, 8-bit style, no text' }
        ];

        // --- Utility Functions ---
        function getApplicationSeason(currentMonth) {
            // currentMonth is 0-indexed (0 for Jan, 11 for Dec)
            const year = new Date().getFullYear();
            const nextYearFall = `${year + 1} Fall`;
            const currentYearSpring = `${year + 1} Spring`; 

            if (currentMonth >= 9 && currentMonth <= 11) { // Oct, Nov, Dec
                return `【${nextYearFall}】申请季（准备期/早鸟申请）`;
            } else if (currentMonth >= 5 && currentMonth <= 8) { // June, July, Aug, Sep
                return `【${year} Fall】申请季（冲刺阶段，部分已截止）`;
            } else { // Jan, Feb, Mar, Apr, May
                return `【${year} Fall / ${currentYearSpring}】申请季（规划期/滚动申请）`;
            }
        }

        function generateDetailedOutline(contentCN) {
            const paragraphs = contentCN.split('。').filter(p => p.trim() !== '');
            const outline = [];

            paragraphs.forEach(p => {
                p = p.trim();
                // Look for strong tags or clear topic sentences
                const strongTagMatch = p.match(/<strong>(.*?)<\/strong>：?/);
                if (strongTagMatch && strongTagMatch[1]) {
                    // Extract text within strong tag, remove trailing colon if present
                    outline.push(strongTagMatch[1].replace(/<\/strong>：?/, '')); 
                } else if (p.length > 30) { // If no strong tag, use first part of longer paragraph
                    outline.push(p.substring(0, Math.min(p.indexOf('，') > 0 ? p.indexOf('，') : 30, p.length)) + '...');
                }
            });
            // Filter out duplicates and very short generic entries
            return [...new Set(outline.filter(item => item.length > 5 && !item.includes('...')))]; // Exclude partial sentences if they are too generic
        }

        // --- 新增：DeepSeek API 动态分析函数 ---
        async function generateDynamicAnalysis(newsItem) {
            // 注意：在实际部署中，API密钥应该存储在服务器端，而不是客户端
            const apiUrl = "https://api.deepseek.com/v1/chat/completions";
            
            // 构建分析提示词
            const prompt = `
                作为RAC设计留学专家，请对以下设计教育资讯进行专业点评：
                
                标题：${newsItem.titleCN}
                原文标题：${newsItem.title}
                类别：${newsItem.category}
                内容摘要：${newsItem.summary}
                发布时间：${newsItem.date}
                
                请提供：
                1. 专业洞察：从设计教育角度分析此资讯的重要性
                2. 申请影响：对设计专业留学生申请的影响
                3. 行动建议：学生应该如何应对或利用此趋势
                4. 行业前瞻：预测未来6-12个月可能的发展
                
                要求：
                - 保持专业但易懂的语气
                - 针对具体资讯内容，避免通用模板
                - 提供可执行的建议
                - 字数控制在200-300字
                - 使用中文回复
            `;
            
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${DEEPSEEK_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: "deepseek-chat",
                        messages: [
                            {
                                role: "system",
                                content: "你是一位资深的设计教育专家，专门为设计专业留学生提供申请指导和建议。回复时使用专业但亲切的语气。"
                            },
                            {
                                role: "user",
                                content: prompt
                            }
                        ],
                        max_tokens: 500,
                        temperature: 0.7
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`API请求失败: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.choices && data.choices[0]) {
                    return `【RAC专家犀利点评】\n${data.choices[0].message.content.trim()}`;
                } else {
                    return generateFallbackAnalysis(newsItem);
                }
                
            } catch (error) {
                console.error("DeepSeek API调用失败:", error);
                // 降级方案：基于内容的简单分析
                return generateFallbackAnalysis(newsItem);
            }
        }

        // 降级分析函数（当API调用失败时使用）
        function generateFallbackAnalysis(newsItem) {
            const categories = {
                'global': '国际设计教育格局',
                'education': '设计教育体系',
                'university': '院校招生策略',
                'design': '设计行业趋势',
                'summer': '暑期学术机会',
                'competitions': '设计竞赛生态'
            };
            
            const impacts = [
                "可能影响未来申请的作品集方向",
                "建议在个人陈述中提及对此趋势的理解",
                "相关技能将成为申请加分项",
                "需要调整选校策略以适应变化"
            ];
            
            const actions = [
                "建议在3个月内完成相关技能学习或项目实践",
                "在作品集中展示对该趋势的思考和应用",
                "关注目标院校相关专业的课程更新",
                "参加相关的线上研讨会或工作坊"
            ];
            
            const randomImpact = impacts[Math.floor(Math.random() * impacts.length)];
            const randomAction = actions[Math.floor(Math.random() * actions.length)];
            
            return `【RAC专家犀利点评】\n针对"${newsItem.titleCN}"的专业分析：
            
1. 趋势解读：此资讯反映了${categories[newsItem.category] || '设计教育领域'}的近期动态，显示了行业对${newsItem.tags[0] || '新兴技术'}的关注度提升。

2. 申请影响：${randomImpact}。特别是对于目标为TOP 20院校的申请者，需要提前布局。

3. 行动建议：${randomAction}，并在作品集中展示对该趋势的思考和应用。

4. 风险提示：避免盲目跟风，应结合个人优势进行差异化准备。`;
        }

        // --- 新增：导出图片优化函数 ---
        function exportToImage(elementId = 'content-to-export') {
            const element = document.getElementById(elementId);
            
            if (!element) {
                console.error('导出元素不存在:', elementId);
                return;
            }
            
            // 保存原始样式
            const originalClasses = element.className;
            
            // 添加优化类名
            element.classList.add('export-optimized');
            
            // 临时调整所有文字元素的样式
            const allTextElements = element.querySelectorAll('h1, h2, h3, h4, h5, h6, p, span, div, li, td, th');
            const originalStyles = [];
            
            allTextElements.forEach((el, index) => {
                originalStyles[index] = {
                    fontSize: el.style.fontSize,
                    lineHeight: el.style.lineHeight,
                    whiteSpace: el.style.whiteSpace
                };
                
                el.classList.add('text-export-safe');
                
                // 确保最小字体大小
                const computedStyle = window.getComputedStyle(el);
                const currentFontSize = parseInt(computedStyle.fontSize);
                
                if (currentFontSize < 14) {
                    el.style.fontSize = '16px';
                }
                
                // 确保行高足够
                if (parseFloat(computedStyle.lineHeight) < 1.4) {
                    el.style.lineHeight = '1.6';
                }
            });
            
            // 使用html2canvas导出
            html2canvas(element, {
                scale: 3, // 提高导出分辨率
                backgroundColor: '#ffffff',
                useCORS: true,
                allowTaint: true,
                logging: false,
                onclone: function(clonedDoc) {
                    // 确保克隆的文档也有优化样式
                    const clonedElement = clonedDoc.getElementById(elementId);
                    if (clonedElement) {
                        clonedElement.classList.add('export-optimized');
                        const clonedTextElements = clonedElement.querySelectorAll('h1, h2, h3, h4, h5, h6, p, span, div, li, td, th');
                        clonedTextElements.forEach(el => {
                            el.classList.add('text-export-safe');
                            const computedStyle = window.getComputedStyle(el);
                            const currentFontSize = parseInt(computedStyle.fontSize);
                            
                            if (currentFontSize < 14) {
                                el.style.fontSize = '16px';
                            }
                            
                            if (parseFloat(computedStyle.lineHeight) < 1.4) {
                                el.style.lineHeight = '1.6';
                            }
                        });
                    }
                }
            }).then(canvas => {
                // 恢复原有样式
                element.className = originalClasses;
                
                allTextElements.forEach((el, index) => {
                    el.classList.remove('text-export-safe');
                    if (originalStyles[index]) {
                        el.style.fontSize = originalStyles[index].fontSize;
                        el.style.lineHeight = originalStyles[index].lineHeight;
                        el.style.whiteSpace = originalStyles[index].whiteSpace;
                    }
                });
                
                // 创建下载链接
                const link = document.createElement('a');
                const timestamp = new Date().toISOString().slice(0,19).replace(/[:T]/g, '-');
                link.download = `RAC-Weekend-Flash-${timestamp}.png`;
                link.href = canvas.toDataURL('image/png', 1.0);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }).catch(error => {
                console.error('导出图片失败:', error);
                alert('导出失败，请重试');
                
                // 确保恢复原有样式
                element.className = originalClasses;
                allTextElements.forEach((el, index) => {
                    el.classList.remove('text-export-safe');
                    if (originalStyles[index]) {
                        el.style.fontSize = originalStyles[index].fontSize;
                        el.style.lineHeight = originalStyles[index].lineHeight;
                        el.style.whiteSpace = originalStyles[index].whiteSpace;
                    }
                });
            });
        }

        // --- Mock Data Generator with REAL URLs & Bilingual Support ---
        async function generateMockNews() {
            const news = [];
            let idCounter = 1;
            const weekOffset = 7 * 24 * 60 * 60 * 1000;
            const now = new Date();
            const currentMonth = now.getMonth(); // 0-indexed

            const currentApplicationSeason = getApplicationSeason(currentMonth);

            // Updated templates with REAL URLs and Chinese Titles
            const templates = {
                global: [
                    { title: "AI Act in EU: How it affects creative industries.", titleCN: "欧盟AI法案：如何影响创意产业", url: "https://digital-strategy.ec.europa.eu/en/policies/regulatory-framework-ai" },
                    { title: "Apple Vision Pro adoption rates skyrocket in design studios.", titleCN: "Apple Vision Pro 在设计工作室的采用率飙升", url: "https://www.apple.com/apple-vision-pro/" },
                    { title: "Climate change architecture symposium held in Rotterdam.", titleCN: "鹿特丹举办气候变化建筑研讨会", url: "https://www.archdaily.com/tag/climate-change" },
                    { title: "Global remote work visa policies updated for digital nomads.", titleCN: "全球数字游民远程工作签证政策更新", url: "https://nomadlist.com/digital-nomad-visas" },
                    { title: "NFT market crash: What's next for digital artists?", titleCN: "NFT市场崩盘：数字艺术家的下一步是什么？", url: "https://techcrunch.com/tag/nfts/" }
                ],
                education: [
                    { title: "RCA announces new Digital Fashion MA program.", titleCN: "RCA 皇家艺术学院宣布新的数字时尚硕士课程", url: "https://www.rca.ac.uk/news-and-events/" },
                    { title: "Parsons faculty strike ends with new curriculum agreement.", titleCN: "帕森斯教职工罢工结束，达成新课程协议", url: "https://www.newschool.edu/parsons/news/" },
                    { title: "UK Student Visa fees increase by 15% effective immediately.", titleCN: "英国学生签证费用即日起上涨15%", url: "https://www.gov.uk/student-visa" },
                    { title: "Comparison of Art School ROI: US vs UK vs Europe.", titleCN: "艺术院校投资回报率比较：美国 vs 英国 vs 欧洲", url: "https://www.qs.com/rankings/" },
                    { title: "New generative AI tools integrated into Architectural Association courses.", titleCN: "新的生成式AI工具整合进AA建筑联盟学院课程", url: "https://www.aaschool.ac.uk/publicprogramme/whatson" }
                ],
                university: [
                    { title: "UCL Bartlett releases 2026 admissions guidelines.", titleCN: "UCL 巴特莱特建筑学院发布2026招生指南", url: "https://www.ucl.ac.uk/bartlett/news" },
                    { title: "Harvard GSD opens applications for Summer research fellows.", titleCN: "哈佛GSD开放暑期研究员申请", url: "https://www.gsd.harvard.edu/news/" },
                    { title: "Politecnico di Milano ranks #1 in Design for 3rd year.", titleCN: "米兰理工大学连续三年设计类排名第一", url: "https://www.polimi.it/en/news" },
                    { title: "Central Saint Martins degree show dates announced.", titleCN: "中央圣马丁毕业展日期公布", url: "https://www.arts.ac.uk/colleges/central-saint-martins/stories" },
                    { title: "RISD creates new scholarship for international students.", titleCN: "RISD 罗德岛设计学院为国际学生设立新奖学金", url: "https://www.risd.edu/news" }
                ],
                design: [
                    { title: "Interaction Design Trend: No-UI interfaces gaining traction.", titleCN: "交互设计趋势：无UI界面正在兴起", url: "https://uxdesign.cc/" },
                    { title: "Sustainable materials: Mycelium bricks in modern housing.", titleCN: "可持续材料：现代住房中的菌丝体砖", url: "https://materialdistrict.com/" },
                    { title: "UX/UI salaries in London vs Shanghai: 2025 Report.", titleCN: "伦敦 vs 上海 UX/UI 薪资：2025年报告", url: "https://www.glassdoor.com/Salaries/index.htm" },
                    { title: "Why Industrial Design is merging with Biology.", titleCN: "为什么工业设计正在与生物学融合", url: "https://www.dezeen.com/design/" },
                    { title: "Game Design: Unreal Engine 6 preview at GDC.", titleCN: "游戏设计：GDC上的虚幻引擎6预览", url: "https://www.unrealengine.com/en-US/blog" }
                ],
                summer: [
                    { title: "AA Visiting School: Amazon Jungle Architecture workshop.", titleCN: "AA 访校：亚马逊丛林建筑研讨会", url: "https://www.aaschool.ac.uk/academicprogrammes/visitingschool" },
                    { title: "Pratt Institute Summer Intensive: Visual Communication.", titleCN: "普瑞特艺术学院暑期强化班：视觉传达", url: "https://www.pratt.edu/continuing-and-professional-studies/precollege/" },
                    { title: "CSM Summer: Experimental Typography in London.", titleCN: "CSM 暑期课程：伦敦实验排版", url: "https://www.arts.ac.uk/colleges/central-saint-martins/short-courses/summer-school" },
                    { title: "Berkley Summer Sessions: Urban Planning & Social Justice.", titleCN: "伯克利暑期课程：城市规划与社会正义", url: "https://summer.berkeley.edu/" },
                    { title: "Parsons Paris: Fashion Management Summer Course.", titleCN: "帕森斯巴黎：时尚管理暑期课程", url: "https://www.newschool.edu/parsons-paris/summer-programs/" }
                ],
                competitions: [
                    { title: "Red Dot Award 2026: Call for entries open.", titleCN: "2026红点奖：报名开启", url: "https://www.red-dot.org/" },
                    { title: "eVolo Skyscraper Competition winners announced.", titleCN: "eVolo 摩天大楼竞赛获奖者公布", url: "https://www.evolo.us/" },
                    { title: "D&AD New Blood Awards: Briefs released.", titleCN: "D&AD 新血奖：简报发布", url: "https://www.dandad.org/en/d-ad-new-blood-awards/" },
                    { title: "IF Design Student Award deadline extended.", titleCN: "IF 设计新秀奖截止日期延长", url: "https://ifdesign.com/en/if-design-student-award" },
                    { title: "Adobe Creative Jam: UI/UX Challenge for students.", titleCN: "Adobe Creative Jam：面向学生的 UI/UX 挑战赛", url: "https://www.adobe.com/education.html" }
                ]
            };

            for (const cat of CATEGORIES) {
                for (let i = 0; i < 5; i++) {
                    let template = templates[cat.id][i];
                    let title, titleCN, url;
                    
                    if (template) {
                        title = template.title;
                        titleCN = template.titleCN;
                        url = template.url;
                    } else {
                        title = `New update in ${cat.name}`;
                        titleCN = `${cat.nameCN} 最新动态`;
                        url = `https://www.google.com/search?q=${encodeURIComponent(title + " design news")}`;
                    }

                    const date = new Date(now.getTime() - Math.random() * weekOffset);
                    const imgSeed = `${idCounter}-${cat.id}-${title.replace(/\W/g, '').substring(0, 10)}`;
                    const imgUrl = `https://picsum.photos/seed/${imgSeed}/800/500`;

                    const fullContentEN = `
                        <p>This development signals a significant shift in the <strong>${cat.name}</strong> sector. Experts suggest that students preparing portfolios should pay close attention to these emerging trends.</p>
                        <p>For applicants targeting top-tier institutions like RCA, UAL, or Ivy League schools, incorporating understanding of this topic could be a differentiator.</p>
                        <br/>
                        <h3>Key Impacts:</h3>
                        <ul>
                            <li>Impact on future admissions criteria.</li>
                            <li>New skillsets required: AI collaboration, sustainable material usage.</li>
                            <li>Increased competitiveness in the global job market for multidisciplinary graduates.</li>
                        </ul>
                    `;
                    const fullContentCN = `
                        <p>针对 <strong>${titleCN}</strong> 这一事件，RAC 教研组认为这标志着 ${cat.nameCN} 领域的一次重要转折。对于正在准备作品集的同学来说，理解这一趋势背后的逻辑至关重要。</p>

                        <h3>行业影响：</h3>
                        <p>此事件将重塑${cat.nameCN}领域的未来发展路径，引发技术与伦理的深度思考。</p>
                        <h3>对申请者的启发：</h3>
                        <p>建议申请者在作品集中融入对该话题的批判性思考，展现解决实际问题的能力。</p>
                        <h3>建议行动：</h3>
                        <ul>
                            <li><strong>关注前沿技术：</strong>积极学习并掌握与该领域相关的新工具和方法。</li>
                            <li><strong>拓展跨学科知识：</strong>尝试将设计与AI、可持续发展等领域相结合。</li>
                            <li><strong>强化项目实践：</strong>通过实际项目展示对趋势的理解和创新应用。</li>
                        </ul>
                        <br/>
                        <p>未来在选择专业和院校时，建议学生和家长密切关注官方发布的最新信息，并结合个人兴趣和职业规划，做出明智的选择。同时，积极参与学校的就业指导和行业交流活动，将有助于更好地适应国际就业市场。</p>
                    `;
                    
                    // 使用 DeepSeek API 生成动态分析
                    const analysis = await generateDynamicAnalysis({
                        id: idCounter,
                        category: cat.id,
                        title: title,
                        titleCN: titleCN,
                        summary: `核心关键词：${cat.nameCN} | 趋势 | 变革。这是一段关于 ${titleCN} 的AI生成摘要。重点在于分析该事件对全球设计教育及留学生的影响。`,
                        date: date.toISOString().split('T')[0],
                        tags: [cat.nameCN, '2026趋势', '热门话题']
                    });

                    news.push({
                        id: idCounter,
                        category: cat.id,
                        title: title,
                        titleCN: titleCN,
                        summary: `核心关键词：${cat.nameCN} | 趋势 | 变革。这是一段关于 ${titleCN} 的AI生成摘要。重点在于分析该事件对全球设计教育及留学生的影响。`,
                        fullContent: fullContentEN,
                        fullContentCN: fullContentCN,
                        analysis: analysis,
                        tags: [cat.nameCN, '2026趋势', '热门话题'],
                        url: url,
                        image: imgUrl,
                        date: date.toISOString()
                    });
                    idCounter++;
                }
            }

            return news.sort((a, b) => a.id - b.id);
        }

        // --- Components ---

        function Icon({ name, size = 20, className }) {
            React.useEffect(() => {
                lucide.createIcons();
            }, [name]);
            return <i data-lucide={name} width={size} height={size} className={className}></i>;
        }

        function Tag({ text, invert = false }) {
            return (
                <span className={`inline-block border-2 border-black px-2 py-0.5 text-xs font-mono mr-2 mb-1 shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] ${invert ? 'bg-black text-white' : 'bg-white text-black'}`}>
                    #{text}
                </span>
            );
        }

        // Sidebar Component
        function Sidebar({ isOpen, onClose, activeCategory, onSelectCategory }) {
            return (
                <>
                    {/* Backdrop */}
                    {isOpen && (
                        <div className="fixed inset-0 bg-black/50 z-40 backdrop-blur-sm" onClick={onClose}></div>
                    )}
                    {/* Sidebar Panel */}
                    <div className={`fixed top-0 left-0 h-full w-3/4 max-w-xs bg-neo-white border-r-4 border-black z-50 transform transition-transform duration-300 ease-in-out ${isOpen ? 'translate-x-0' : '-translate-x-full'} overflow-y-auto`}>
                        <div className="p-4 border-b-4 border-black bg-black text-white flex justify-between items-center">
                            <span className="font-black text-xl italic">MENU / 菜单</span>
                            <button onClick={onClose}>
                                <Icon name="x" size={24} className="text-white" />
                            </button>
                        </div>
                        
                        <div className="p-6">
                            <div className="mb-8">
                                <h3 className="font-mono font-bold text-gray-400 mb-4 border-b-2 border-gray-300 pb-1">SECTIONS / 分类</h3>
                                <button 
                                    onClick={() => { onSelectCategory('all'); onClose(); }}
                                    className={`block w-full text-left font-black text-xl mb-4 hover:text-neo-main transition-colors ${activeCategory === 'all' ? 'text-neo-main underline' : 'text-black'}`}
                                >
                                    ALL NEWS (全部)
                                </button>
                                {CATEGORIES.map(cat => (
                                    <button 
                                        key={cat.id}
                                        onClick={() => { onSelectCategory(cat.id); onClose(); }}
                                        className={`block w-full text-left font-bold text-lg mb-4 hover:text-neo-main transition-colors ${activeCategory === cat.id ? 'text-neo-main underline' : 'text-black'}`}
                                    >
                                        <span className="block font-black text-xl uppercase">{cat.name}</span>
                                        <span className="text-sm font-normal text-gray-600">{cat.nameCN}</span>
                                    </button>
                                ))}
                            </div>

                            <div className="mb-8">
                                <h3 className="font-mono font-bold text-gray-400 mb-4 border-b-2 border-gray-300 pb-1">ARCHIVES / 归档</h3>
                                <div className="space-y-3 font-mono font-bold">
                                    <div className="flex justify-between items-center opacity-50 cursor-not-allowed">
                                        <span>MAR 2026 (3月)</span>
                                        <Icon name="lock" size={14} />
                                    </div>
                                    <div className="flex justify-between items-center opacity-50 cursor-not-allowed">
                                        <span>FEB 2026 (2月)</span>
                                        <Icon name="lock" size={14} />
                                    </div>
                                    <div className="flex justify-between items-center opacity-50 cursor-not-allowed">
                                        <span>JAN 2026 (1月)</span>
                                        <Icon name="lock" size={14} />
                                    </div>
                                </div>
                            </div>

                             <div className="bg-neo-yellow border-2 border-black p-4 shadow-neo-sm">
                                <h4 className="font-bold text-sm mb-2">NEED HELP? / 遇到问题？</h4>
                                <p className="text-xs mb-3 font-mono">Book a session with our portfolio experts.<br/>预约作品集专家咨询。</p>
                                <a href={WECHAT_WORK_URL} target="_blank" rel="noopener noreferrer" className="block w-full bg-black text-white text-center py-2 font-bold text-xs hover:bg-white hover:text-black hover:border-black border-2 border-transparent transition-all">
                                    CONTACT SUPPORT / 联系客服
                                </a>
                            </div>
                        </div>
                    </div>
                </>
            );
        }

        function NewsCard({ item, onClick, categoryColor }) {
            return (
                <div 
                    onClick={onClick}
                    className="bg-white border-4 border-black p-0 mb-6 shadow-neo active:translate-x-1 active:translate-y-1 active:shadow-none transition-all cursor-pointer relative overflow-hidden group flex flex-col h-full"
                >
                    <div className="relative h-48 w-full overflow-hidden border-b-4 border-black bg-gray-200">
                        <img 
                            src={item.image} 
                            alt={item.titleCN} 
                            className="absolute inset-0 w-full h-full object-cover transition-all duration-500 transform group-hover:scale-105"
                            loading="lazy"
                            onError={(e) => { e.target.onerror = null; e.target.src="https://via.placeholder.com/800x500/F0F0F0/000000?text=Image+Load+Error"; }}
                        />
                        <div className="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent flex flex-col justify-end p-4">
                            <div className={`absolute top-0 left-0 ${categoryColor} px-3 py-1 border-r-4 border-b-4 border-black font-black text-sm tracking-tighter text-black`}>
                                #{item.id.toString().padStart(2, '0')}
                            </div>
                            <h3 className="text-white text-xl font-black leading-tight line-clamp-2 mb-1">{item.titleCN}</h3>
                        </div>
                    </div>
                    <div className="p-4 flex-grow flex flex-col justify-between">
                        <div>
                            <div className="flex flex-wrap mb-3 gap-1">
                                {item.tags.slice(0, 2).map((t, i) => <Tag key={i} text={t} />)}
                            </div>
                            <h3 className="font-black text-lg leading-tight mb-2 uppercase hover:text-neo-accent line-clamp-2">{item.title}</h3>
                            <p className="text-sm text-gray-600 font-mono line-clamp-2 leading-tight mb-3">{item.summary.split('。')[0]}...</p>
                            
                            {/* 分析预览 */}
                            <div className="analysis-preview text-xs text-gray-700 bg-gray-50 p-2 rounded border-l-2 border-neo-accent mb-2">
                                <strong className="text-neo-main">专家洞察：</strong>
                                <span className="line-clamp-2 ml-1">
                                    {item.analysis ? 
                                        item.analysis.replace('【RAC专家犀利点评】\n', '').substring(0, 80) + '...' : 
                                        '分析加载中...'}
                                </span>
                            </div>
                        </div>
                        
                        <div className="mt-4 pt-3 border-t-2 border-black flex justify-between items-center">
                            <span className="text-xs font-bold bg-black text-white px-2 py-0.5">{item.date.split('T')[0]}</span>
                            <div className="w-6 h-6 rounded-full bg-neo-main border-2 border-black flex items-center justify-center group-hover:bg-neo-yellow transition-colors">
                                <Icon name="arrow-right" size={14} className="text-white group-hover:text-black" />
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        function DetailModal({ item, onClose, categoryColor }) {
            if (!item) return null;

            // Generate outline for Chinese content
            const outline = generateDetailedOutline(item.fullContentCN);
            
            const handleExport = () => {
                const modalContent = document.getElementById('modal-content');
                if (modalContent) {
                    exportToImage('modal-content');
                } else {
                    exportToImage();
                }
            };

            return (
                <div className="fixed inset-0 z-50 overflow-hidden bg-neo-bg bg-opacity-95 backdrop-blur-sm flex justify-center animate-fade-in">
                    <div id="modal-content" className="bg-white w-full max-w-2xl h-full md:h-[90vh] md:my-auto md:border-4 md:border-black md:shadow-neo relative flex flex-col overflow-hidden">
                        
                        <div className="bg-white border-b-4 border-black flex justify-between items-center p-3 shrink-0 z-20">
                            <div className="flex items-center gap-2">
                                <span className={`inline-block px-2 py-1 border-2 border-black font-black text-sm ${categoryColor} text-black`}>
                                    {item.category.toUpperCase()}
                                </span>
                                <span className="font-mono font-bold text-gray-500">#{item.id.toString().padStart(2, '0')}</span>
                            </div>
                            <button onClick={onClose} className="bg-black text-white border-2 border-transparent hover:bg-neo-main hover:border-black transition-colors p-1">
                                <Icon name="x" size={24} />
                            </button>
                        </div>

                        <div className="flex-grow overflow-y-auto overflow-x-hidden bg-white">
                            <div className="relative w-full h-56 md:h-72 border-b-4 border-black shrink-0">
                                <img src={item.image} className="absolute inset-0 w-full h-full object-cover" alt="Detail Hero" 
                                     onError={(e) => { e.target.onerror = null; e.target.src="https://via.placeholder.com/800x500/F0F0F0/000000?text=Image+Load+Error"; }} />
                                <div className="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent pointer-events-none"></div>
                                <div className="absolute inset-x-0 bottom-0 p-5 text-white z-10">
                                    <h1 className="text-2xl md:text-3xl font-black uppercase leading-none tracking-tight mb-2">{item.titleCN}</h1>
                                    <h2 className="text-lg md:text-xl font-bold text-gray-300 mb-2">{item.title}</h2>
                                </div>
                            </div>
                            
                            <div className="p-5 md:p-8">
                                <div className="mb-6 border-b-4 border-black pb-6">
                                    <div className="flex flex-wrap gap-2 mb-3">
                                        {item.tags.map((t,i) => <Tag key={i} text={t} invert={true} />)}
                                    </div>
                                    
                                    {outline.length > 0 && (
                                        <div className="bg-gray-50 border-2 border-black p-4 mb-4">
                                            <h3 className="font-black text-lg mb-2 flex items-center">
                                                <Icon name="list-ordered" className="mr-2 text-neo-accent" />
                                                内容概要
                                            </h3>
                                            <ul className="space-y-1">
                                                {outline.map((point, idx) => (
                                                    <li key={idx} className="flex items-start">
                                                        <span className="inline-block w-2 h-2 bg-black mt-2 mr-2 flex-shrink-0"></span>
                                                        <span className="text-sm">{point}</span>
                                                    </li>
                                                ))}
                                            </ul>
                                        </div>
                                    )}
                                    
                                    <div className="prose-neo max-w-none" dangerouslySetInnerHTML={{ __html: item.fullContentCN }}></div>
                                    
                                    <div className="mt-6 pt-4 border-t-2 border-dashed border-gray-300">
                                        <a 
                                            href={item.url} 
                                            target="_blank" 
                                            rel="noopener noreferrer"
                                            className="inline-flex items-center bg-neo-accent text-white border-2 border-black px-4 py-2 font-bold hover:bg-neo-yellow hover:text-black transition-all shadow-neo-sm"
                                        >
                                            <Icon name="external-link" className="mr-2" size={16} />
                                            查看原始报道
                                        </a>
                                    </div>
                                </div>
                                
                                {/* 动态生成的RAC专家点评 */}
                                <div className="mt-8 p-4 bg-gradient-to-r from-gray-50 to-white border-4 border-black shadow-neo-sm">
                                    <h3 className="font-black text-xl mb-4 flex items-center">
                                        <Icon name="lightbulb" className="mr-2 text-neo-yellow" />
                                        RAC专家犀利点评
                                    </h3>
                                    <div className="analysis-content whitespace-pre-line text-gray-800 leading-relaxed">
                                        {item.analysis || '分析加载中...'}
                                    </div>
                                    <div className="mt-4 text-xs text-gray-500 flex items-center">
                                        <Icon name="clock" size={12} className="mr-1" />
                                        分析生成时间：{new Date().toLocaleString('zh-CN')}
                                    </div>
                                </div>
                                
                                {/* 导出按钮 */}
                                <div className="mt-8 flex justify-center">
                                    <button 
                                        onClick={handleExport}
                                        className="bg-neo-main text-white border-2 border-black px-6 py-3 font-black hover:bg-neo-yellow hover:text-black transition-all shadow-neo active:shadow-none active:translate-x-1 active:translate-y-1"
                                    >
                                        <Icon name="download" className="inline mr-2" />
                                        导出本页分析
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div className="bg-black text-white p-3 text-center text-xs font-mono border-t-4 border-neo-main">
                            RAC Weekend Flash © 2026 - 仅供内部参考
                        </div>
                    </div>
                </div>
            );
        }

        // Main App Component
        function App() {
            const [news, setNews] = React.useState([]);
            const [filteredNews, setFilteredNews] = React.useState([]);
            const [selectedCategory, setSelectedCategory] = React.useState('all');
            const [sidebarOpen, setSidebarOpen] = React.useState(false);
            const [selectedNews, setSelectedNews] = React.useState(null);
            const [loading, setLoading] = React.useState(true);
            
            // 导出整个页面
            const handleExportAll = () => {
                exportToImage('content-to-export');
            };
            
            React.useEffect(() => {
                async function loadNews() {
                    setLoading(true);
                    try {
                        const newsData = await generateMockNews();
                        setNews(newsData);
                        setFilteredNews(newsData);
                    } catch (error) {
                        console.error('加载新闻失败:', error);
                        // 降级：使用不带分析的数据
                        const fallbackData = await generateMockNews();
                        setNews(fallbackData);
                        setFilteredNews(fallbackData);
                    } finally {
                        setLoading(false);
                    }
                }
                
                loadNews();
            }, []);
            
            React.useEffect(() => {
                if (selectedCategory === 'all') {
                    setFilteredNews(news);
                } else {
                    setFilteredNews(news.filter(item => item.category === selectedCategory));
                }
            }, [selectedCategory, news]);
            
            const getCategoryInfo = (categoryId) => {
                return CATEGORIES.find(cat => cat.id === categoryId) || CATEGORIES[0];
            };
            
            return (
                <div id="content-to-export" className="min-h-screen bg-neo-bg">
                    {/* Header */}
                    <header className="sticky top-0 z-30 bg-neo-white border-b-4 border-black">
                        <div className="container mx-auto px-4 py-3">
                            <div className="flex justify-between items-center">
                                <button 
                                    onClick={() => setSidebarOpen(true)}
                                    className="bg-black text-white border-2 border-black hover:bg-neo-main hover:border-black p-2 transition-colors"
                                >
                                    <Icon name="menu" size={24} />
                                </button>
                                
                                <div className="text-center">
                                    <h1 className="font-display text-2xl md:text-3xl font-black tracking-tighter uppercase">
                                        RAC WEEKEND FLASH
                                    </h1>
                                    <p className="font-mono text-xs md:text-sm text-gray-600">周末闪讯 · 设计留学前沿</p>
                                </div>
                                
                                <button 
                                    onClick={handleExportAll}
                                    className="bg-neo-main text-white border-2 border-black hover:bg-neo-yellow hover:text-black px-3 py-2 font-bold text-sm transition-colors shadow-neo-sm active:shadow-none"
                                >
                                    <Icon name="download" className="inline mr-1" size={16} />
                                    导出
                                </button>
                            </div>
                        </div>
                        
                        {/* Category Filter Tabs */}
                        <div className="border-t-2 border-black">
                            <div className="container mx-auto px-4">
                                <div className="flex overflow-x-auto scrollbar-hide -mb-0.5">
                                    <button
                                        onClick={() => setSelectedCategory('all')}
                                        className={`flex-shrink-0 px-4 py-2 font-black text-sm border-b-4 ${selectedCategory === 'all' ? 'border-neo-main text-neo-main' : 'border-transparent text-gray-500 hover:text-black'}`}
                                    >
                                        ALL
                                    </button>
                                    {CATEGORIES.map(cat => (
                                        <button
                                            key={cat.id}
                                            onClick={() => setSelectedCategory(cat.id)}
                                            className={`flex-shrink-0 px-4 py-2 font-black text-sm border-b-4 ${selectedCategory === cat.id ? `border-${cat.color.split(' ')[1]} text-${cat.color.split(' ')[1]}` : 'border-transparent text-gray-500 hover:text-black'}`}
                                        >
                                            {cat.name}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </header>
                    
                    {/* Main Content */}
                    <main className="container mx-auto px-4 py-8">
                        {loading ? (
                            <div className="flex justify-center items-center h-64">
                                <div className="loader"></div>
                                <span className="ml-4 font-mono font-bold">加载新闻中...</span>
                            </div>
                        ) : (
                            <>
                                {/* Stats Bar */}
                                <div className="bg-white border-4 border-black p-4 mb-6 shadow-neo-sm">
                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                                        <div>
                                            <div className="font-black text-2xl">{news.length}</div>
                                            <div className="text-xs font-mono text-gray-600">总资讯数</div>
                                        </div>
                                        <div>
                                            <div className="font-black text-2xl text-neo-main">{filteredNews.length}</div>
                                            <div className="text-xs font-mono text-gray-600">当前分类</div>
                                        </div>
                                        <div>
                                            <div className="font-black text-2xl text-neo-accent">6</div>
                                            <div className="text-xs font-mono text-gray-600">分类数量</div>
                                        </div>
                                        <div>
                                            <div className="font-black text-2xl text-neo-green">24/7</div>
                                            <div className="text-xs font-mono text-gray-600">实时更新</div>
                                        </div>
                                    </div>
                                </div>
                                
                                {/* News Grid */}
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    {filteredNews.map(item => {
                                        const catInfo = getCategoryInfo(item.category);
                                        return (
                                            <NewsCard
                                                key={item.id}
                                                item={item}
                                                onClick={() => setSelectedNews(item)}
                                                categoryColor={catInfo.color}
                                            />
                                        );
                                    })}
                                </div>
                                
                                {filteredNews.length === 0 && (
                                    <div className="text-center py-16">
                                        <div className="text-6xl mb-4">🚀</div>
                                        <h3 className="font-black text-2xl mb-2">暂无该分类资讯</h3>
                                        <p className="text-gray-600 mb-6">请尝试选择其他分类或稍后再来查看</p>
                                        <button 
                                            onClick={() => setSelectedCategory('all')}
                                            className="bg-black text-white border-2 border-black px-6 py-3 font-bold hover:bg-neo-main transition-colors"
                                        >
                                            查看全部资讯
                                        </button>
                                    </div>
                                )}
                            </>
                        )}
                    </main>
                    
                    {/* Footer */}
                    <footer className="bg-black text-white border-t-4 border-neo-main safe-bottom">
                        <div className="container mx-auto px-4 py-6">
                            <div className="flex flex-col md:flex-row justify-between items-center">
                                <div className="mb-4 md:mb-0">
                                    <h3 className="font-black text-xl mb-2">RAC WEEKEND FLASH</h3>
                                    <p className="text-gray-400 text-sm font-mono">设计留学 · 前沿资讯 · 专业分析</p>
                                </div>
                                
                                <div className="flex space-x-4">
                                    <a href={WECHAT_WORK_URL} target="_blank" rel="noopener noreferrer" className="bg-neo-main text-white border-2 border-neo-main hover:bg-white hover:text-neo-main px-4 py-2 font-bold text-sm transition-colors">
                                        在线咨询
                                    </a>
                                    <button 
                                        onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })}
                                        className="bg-transparent text-white border-2 border-white hover:bg-white hover:text-black px-4 py-2 font-bold text-sm transition-colors"
                                    >
                                        回到顶部
                                    </button>
                                </div>
                            </div>
                            
                            <div className="mt-6 pt-6 border-t border-gray-800 text-center text-gray-500 text-xs font-mono">
                                <p>© 2026 RAC Weekend Flash. 本页面内容为模拟数据，仅供演示使用。</p>
                                <p className="mt-1">API密钥已集成，请勿在实际生产环境中暴露客户端密钥。</p>
                            </div>
                        </div>
                    </footer>
                    
                    {/* Sidebar */}
                    <Sidebar
                        isOpen={sidebarOpen}
                        onClose={() => setSidebarOpen(false)}
                        activeCategory={selectedCategory}
                        onSelectCategory={setSelectedCategory}
                    />
                    
                    {/* Detail Modal */}
                    {selectedNews && (
                        <DetailModal
                            item={selectedNews}
                            onClose={() => setSelectedNews(null)}
                            categoryColor={getCategoryInfo(selectedNews.category).color}
                        />
                    )}
                </div>
            );
        }

        // Initialize the app
        ReactDOM.render(<App />, document.getElementById('root'));
        
        // Initialize icons
        lucide.createIcons();
    </script>
</body>
</html>
